<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Four Foot Spider Robot - Yiqing Zhi</title>
    <link rel="icon" type="image/x-icon" href="Images/favicon.ico">
    <!-- Three.js 3D Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #000000;
            position: relative;
            overflow-x: hidden;
        }

        html {
            scroll-behavior: smooth;
        }

        /* Enhanced Galaxy Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(ellipse at 15% 25%, rgba(75, 0, 130, 0.5) 0%, transparent 50%),
                radial-gradient(ellipse at 85% 75%, rgba(138, 43, 226, 0.4) 0%, transparent 45%),
                radial-gradient(ellipse at 50% 50%, rgba(25, 25, 112, 0.6) 0%, transparent 70%),
                radial-gradient(ellipse at 70% 30%, rgba(72, 61, 139, 0.3) 0%, transparent 60%),
                linear-gradient(180deg, #000000 0%, #0d0221 30%, #1a0b3d 60%, #2d1b69 100%);
            animation: galaxyRotate 60s linear infinite;
        }

        @keyframes galaxyRotate {
            0% { background-position: 0% 0%, 100% 100%, 50% 50%, 70% 30%, 0% 0%; }
            100% { background-position: 100% 100%, 0% 0%, 60% 40%, 30% 70%, 0% 0%; }
        }

        /* Progress Bar - Spider Crawler */
        .progress-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, 
                rgba(102, 126, 234, 0.3) 0%,
                rgba(118, 75, 162, 0.3) 50%,
                rgba(240, 147, 251, 0.3) 100%);
            z-index: 1000;
            pointer-events: none;
            overflow: visible;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, 
                #667eea 0%, 
                #764ba2 25%, 
                #f093fb 50%, 
                #4facfe 75%,
                #00f2fe 100%);
            background-size: 200% 100%;
            width: 0%;
            transition: width 0.1s ease-out;
            box-shadow: 
                0 0 20px rgba(102, 126, 234, 0.8),
                0 0 40px rgba(118, 75, 162, 0.6);
            animation: progressGlow 3s ease-in-out infinite;
            position: relative;
        }

        .progress-spider {
            position: absolute;
            bottom: -8px;
            right: -15px;
            font-size: 1.5rem;
            filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.9))
                    drop-shadow(0 0 20px rgba(240, 147, 251, 0.7));
            animation: spiderCrawl 0.5s ease-in-out infinite;
            transform: scaleX(1) rotate(90deg);
            transform-origin: center;
        }

        /* Spider silk thread trailing behind */
        .progress-spider::before {
            content: '';
            position: absolute;
            top: -30px;
            left: 50%;
            width: 2px;
            height: 30px;
            background: linear-gradient(to bottom,
                rgba(255, 255, 255, 0.6) 0%,
                rgba(255, 255, 255, 0.4) 50%,
                rgba(255, 255, 255, 0.2) 100%
            );
            transform: translateX(-50%);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
            animation: silkWave 2s ease-in-out infinite;
        }

        /* Additional web anchor point */
        .progress-spider::after {
            content: '•';
            position: absolute;
            top: -32px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.5rem;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
            animation: anchorGlow 2s ease-in-out infinite;
        }

        @keyframes spiderCrawl {
            0%, 100% {
                transform: scaleX(1) rotate(90deg) translateX(0);
            }
            25% {
                transform: scaleX(1) rotate(90deg) translateX(-1px);
            }
            75% {
                transform: scaleX(1) rotate(90deg) translateX(-1px);
            }
        }

        @keyframes silkWave {
            0%, 100% {
                opacity: 0.6;
                transform: translateX(-50%) scaleY(1);
            }
            50% {
                opacity: 0.8;
                transform: translateX(-50%) scaleY(1.1);
            }
        }

        @keyframes anchorGlow {
            0%, 100% {
                opacity: 0.7;
                text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
            }
            50% {
                opacity: 1;
                text-shadow: 0 0 15px rgba(255, 255, 255, 1);
            }
        }

        @keyframes progressGlow {
            0%, 100% {
                background-position: 0% 50%;
                box-shadow: 
                    0 0 20px rgba(102, 126, 234, 0.8),
                    0 0 40px rgba(118, 75, 162, 0.6);
            }
            50% {
                background-position: 100% 50%;
                box-shadow: 
                    0 0 30px rgba(102, 126, 234, 1),
                    0 0 60px rgba(118, 75, 162, 0.8);
            }
        }

        /* SPIDER WEB TRAIL */
        .progress-bar::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 100%;
            background: repeating-linear-gradient(
                -45deg,
                transparent 0px,
                rgba(255, 255, 255, 0.1) 2px,
                transparent 4px,
                transparent 8px
            ),
            repeating-linear-gradient(
                45deg,
                transparent 0px,
                rgba(255, 255, 255, 0.1) 2px,
                transparent 4px,
                transparent 8px
            ),
            linear-gradient(to left,
                rgba(102, 126, 234, 0) 0%,
                rgba(102, 126, 234, 0.2) 20%,
                rgba(118, 75, 162, 0.3) 40%,
                rgba(240, 147, 251, 0.2) 60%,
                rgba(79, 172, 254, 0.15) 80%,
                rgba(0, 242, 254, 0.1) 100%
            );
            filter: blur(3px);
            opacity: 0.6;
            animation: webPulse 2s ease-in-out infinite;
        }

        /* SPIDER WEB PATTERN */
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 50%;
            right: 30px;
            width: 180px;
            height: 100%;
            transform: translateY(-50%);
            opacity: 0.4;
            background: 
                /* Radial web pattern */
                repeating-radial-gradient(
                    circle at 100% 50%,
                    transparent 0px,
                    rgba(255, 255, 255, 0.3) 1px,
                    transparent 2px,
                    transparent 15px
                ),
                /* Spiral web lines */
                repeating-linear-gradient(
                    90deg,
                    transparent 0px,
                    rgba(255, 255, 255, 0.2) 1px,
                    transparent 2px,
                    transparent 20px
                );
            animation: webShimmer 3s ease-in-out infinite;
            filter: blur(0.5px);
        }

        @keyframes webPulse {
            0%, 100% {
                opacity: 0.6;
                filter: blur(3px);
            }
            50% {
                opacity: 0.8;
                filter: blur(2px);
            }
        }

        @keyframes webShimmer {
            0%, 100% {
                opacity: 0.4;
            }
            50% {
                opacity: 0.6;
            }
        }

        /* Navigation - Matching Main Portfolio */
        nav {
            background: linear-gradient(180deg, 
                rgba(10, 14, 35, 0.98) 0%,
                rgba(15, 20, 45, 0.95) 100%);
            backdrop-filter: blur(15px);
            padding: 1rem 2rem;
            box-shadow: 
                0 4px 30px rgba(102, 126, 234, 0.3),
                inset 0 1px 0 rgba(102, 126, 234, 0.2);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 2px solid rgba(102, 126, 234, 0.4);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-logo {
            height: 40px;
            width: auto;
            border-radius: 10px;
            transition: all 0.3s ease;
            filter: drop-shadow(0 4px 15px rgba(102, 126, 234, 0.5));
            cursor: pointer;
        }

        .nav-logo:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 6px 25px rgba(102, 126, 234, 0.8));
        }

        .back-btn {
            padding: 0.7rem 1.8rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            border: 2px solid rgba(102, 126, 234, 0.5);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        .back-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.5s ease, height 0.5s ease;
        }

        .back-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .back-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
            color: white;
        }

        .back-btn span {
            position: relative;
            z-index: 1;
        }

        /* Hero Section with Parallax */
        .project-hero {
            position: relative;
            height: 65vh;
            min-height: 550px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            margin-bottom: 4rem;
            border-radius: 0 0 20px 20px;
        }

        /* Soft background image layer */
        .project-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('Images/spider_robot_hero.jpg') center center / cover no-repeat;
            filter: blur(8px) brightness(0.4) contrast(0.8);
            transform: scale(1.1);
            z-index: 0;
        }

        /* Gradient overlay */
        .project-hero::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg,
                rgba(10, 14, 35, 0.7) 0%,
                rgba(13, 2, 33, 0.6) 25%,
                rgba(26, 11, 61, 0.5) 50%,
                rgba(45, 27, 105, 0.6) 75%,
                rgba(10, 14, 35, 0.7) 100%
            );
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: white;
            max-width: 900px;
            padding: 2rem;
        }

        .hero-content h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            text-shadow: 
                0 0 30px rgba(0, 0, 0, 0.9),
                0 4px 10px rgba(0, 0, 0, 0.8),
                0 0 60px rgba(102, 126, 234, 0.6);
            letter-spacing: 2px;
            font-weight: 700;
        }

        .hero-content .subtitle {
            font-size: 1.4rem;
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.9);
            line-height: 1.6;
        }

        /* Corner Decorations */
        .carousel-corner {
            position: absolute;
            width: 40px;
            height: 40px;
            border: 3px solid #667eea;
            z-index: 10;
            pointer-events: none;
        }

        .corner-tl {
            top: 15px;
            left: 15px;
            border-right: none;
            border-bottom: none;
            box-shadow: -2px -2px 20px rgba(102, 126, 234, 0.6);
        }

        .corner-tr {
            top: 15px;
            right: 15px;
            border-left: none;
            border-bottom: none;
            box-shadow: 2px -2px 20px rgba(102, 126, 234, 0.6);
        }

        .corner-bl {
            bottom: 15px;
            left: 15px;
            border-right: none;
            border-top: none;
            box-shadow: -2px 2px 20px rgba(102, 126, 234, 0.6);
        }

        .corner-br {
            bottom: 15px;
            right: 15px;
            border-left: none;
            border-top: none;
            box-shadow: 2px 2px 20px rgba(102, 126, 234, 0.6);
        }

        /* 3D Model Viewer Styles */
        #hero-3d-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
        }

        .model-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            background: rgba(10, 14, 35, 0.95);
            backdrop-filter: blur(15px);
            padding: 1rem 1.5rem;
            border-radius: 50px;
            border: 2px solid rgba(102, 126, 234, 0.5);
            display: flex;
            gap: 0.8rem;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.4);
        }

        .model-control-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .model-control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .model-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            background: rgba(10, 14, 35, 0.9);
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.5);
        }

        .model-loading.hidden {
            display: none;
        }

        /* Side Info Cards */
        .side-info-cards {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 3;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .side-info-cards.left {
            left: 30px;
        }

        .side-info-cards.right {
            right: 30px;
        }

        .info-card {
            background: rgba(10, 14, 35, 0.85);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(102, 126, 234, 0.4);
            border-radius: 15px;
            padding: 1.2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            min-width: 200px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            transition: all 0.4s ease;
            opacity: 0;
            animation: slideInCard 0.8s ease forwards;
        }

        @keyframes slideInCard {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .side-info-cards.right .info-card {
            animation: slideInCardRight 0.8s ease forwards;
        }

        @keyframes slideInCardRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .info-card:hover {
            transform: translateX(10px);
            border-color: rgba(102, 126, 234, 0.8);
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.5);
        }

        .side-info-cards.right .info-card:hover {
            transform: translateX(-10px);
        }

        .info-icon {
            font-size: 2.5rem;
            filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.6));
            flex-shrink: 0;
        }

        .info-text h4 {
            color: #667eea;
            font-size: 0.95rem;
            margin: 0 0 0.3rem 0;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .info-text p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.85rem;
            margin: 0;
            font-weight: 600;
        }

        /* Content Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem 4rem;
        }

        .content-section {
            background: rgba(10, 14, 35, 0.95);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 3rem;
            margin-bottom: 3rem;
            box-shadow: 
                0 10px 40px rgba(0, 0, 0, 0.3),
                0 0 60px rgba(102, 126, 234, 0.2);
            position: relative;
            overflow: hidden;
        }

        .content-section::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, 
                #667eea 0%, 
                #764ba2 25%, 
                #f093fb 50%, 
                #667eea 75%, 
                #764ba2 100%);
            background-size: 300% 300%;
            border-radius: 15px;
            z-index: -1;
            animation: borderGlow 6s linear infinite;
            opacity: 0.3;
        }

        @keyframes borderGlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .section-title {
            font-size: 2.5rem;
            color: #667eea;
            margin-bottom: 2rem;
            text-shadow: 0 0 20px rgba(102, 126, 234, 0.6);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-content {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .section-content p {
            margin-bottom: 1.5rem;
        }

        .section-content h3 {
            color: #f093fb;
            font-size: 1.8rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            text-shadow: 0 0 15px rgba(240, 147, 251, 0.5);
        }

        .section-content ul {
            list-style: none;
            padding-left: 0;
            margin: 1.5rem 0;
        }

        .section-content ul li {
            position: relative;
            padding-left: 2rem;
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.85);
            transition: all 0.3s ease;
        }

        .section-content ul li::before {
            content: '▸';
            position: absolute;
            left: 0;
            color: #667eea;
            font-size: 1.5rem;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.8);
        }

        .section-content ul li:hover {
            padding-left: 2.5rem;
            color: rgba(255, 255, 255, 1);
        }

        /* Image Gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        /* ========================================
        3D ROTATING CAROUSEL GALLERY
        ======================================== */

        .carousel-container {
            position: relative;
            width: 100%;
            height: 600px;
            margin: 3rem 0;
            perspective: 2000px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .carousel-track {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .carousel-slide {
            position: absolute;
            width: 500px;
            height: 400px;
            border-radius: 20px;
            overflow: hidden;
            border: 3px solid rgba(102, 126, 234, 0.5);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            background: rgba(10, 14, 35, 0.9);
        }

        /* Center slide - active */
        .carousel-slide.active {
            z-index: 10;
            transform: translateX(0) scale(1) rotateY(0deg);
            opacity: 1;
            filter: brightness(1) blur(0);
            border-color: rgba(102, 126, 234, 1);
            box-shadow: 
                0 30px 80px rgba(102, 126, 234, 0.6),
                0 0 60px rgba(102, 126, 234, 0.4);
        }

        /* Left slide - behind */
        .carousel-slide.left {
            z-index: 5;
            transform: translateX(-65%) scale(0.75) rotateY(25deg);
            opacity: 0.4;
            filter: brightness(0.6) blur(3px);
        }

        /* Right slide - behind */
        .carousel-slide.right {
            z-index: 5;
            transform: translateX(65%) scale(0.75) rotateY(-25deg);
            opacity: 0.4;
            filter: brightness(0.6) blur(3px);
        }

        /* Hidden slides */
        .carousel-slide.hidden {
            z-index: 1;
            transform: translateX(0) scale(0.5);
            opacity: 0;
            pointer-events: none;
        }

        .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }

        .carousel-slide.active img {
            object-fit: cover;
        }

        .carousel-slide:hover.active img {
            transform: scale(1.05);
        }

        /* Caption - only show on active slide */
        .carousel-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1.5rem;
            background: linear-gradient(to top,
                rgba(10, 14, 35, 0.98) 0%,
                rgba(10, 14, 35, 0.95) 70%,
                transparent 100%);
            backdrop-filter: blur(10px);
            color: white;
            transform: translateY(100%);
            transition: transform 0.5s ease;
            z-index: 20;
        }

        .carousel-slide.active:hover .carousel-caption {
            transform: translateY(0);
        }

        .carousel-caption h4 {
            font-size: 1.3rem;
            color: #667eea;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.8);
        }

        .carousel-caption p {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
            margin: 0;
        }

        .carousel-caption .short-desc {
            display: block;
        }

        .carousel-caption .long-desc {
            display: none;
        }

        .carousel-caption.expanded .short-desc {
            display: none;
        }

        .carousel-caption.expanded .long-desc {
            display: block;
        }

        .caption-expand-btn {
            display: inline-block;
            margin-top: 0.5rem;
            padding: 0.3rem 0.8rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .caption-expand-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.6);
        }

        .carousel-caption.expanded .caption-expand-btn {
            background: linear-gradient(135deg, #f093fb 0%, #667eea 100%);
        }

        /* Carousel Controls */
        .carousel-controls {
            position: absolute;
            bottom: -80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 2rem;
            z-index: 15;
        }

        .carousel-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
        }

        .carousel-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.8);
        }

        .carousel-btn:active {
            transform: scale(0.95);
        }

        .carousel-dots {
            display: flex;
            gap: 0.8rem;
        }

        .carousel-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(102, 126, 234, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .carousel-dot.active {
            background: #667eea;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.9);
            transform: scale(1.3);
        }

        .carousel-dot:hover {
            background: rgba(102, 126, 234, 0.6);
            transform: scale(1.2);
        }

        .carousel-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 25;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
        }

        /* Mobile Responsive Carousel */
        @media (max-width: 768px) {
            .carousel-container {
                height: 450px;
            }
            
            .carousel-slide {
                width: 320px;
                height: 280px;
            }
            
            .carousel-slide.left,
            .carousel-slide.right {
                transform: translateX(0) scale(0.6);
                opacity: 0.2;
                filter: brightness(0.4) blur(5px);
            }
            
            .carousel-slide.left {
                transform: translateX(-85%) scale(0.6);
            }
            
            .carousel-slide.right {
                transform: translateX(85%) scale(0.6);
            }
            
            .carousel-controls {
                bottom: -70px;
            }
            
            .carousel-btn {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }
        }

        /* Image Gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            transition: all 0.4s ease;
            cursor: pointer;
            background: rgba(10, 14, 35, 0.8);
            height: 400px;
        }

        .gallery-item:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: rgba(102, 126, 234, 0.8);
            box-shadow: 
                0 20px 50px rgba(102, 126, 234, 0.5),
                0 0 40px rgba(102, 126, 234, 0.3);
        }

        .gallery-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg,
                rgba(102, 126, 234, 0.2) 0%,
                transparent 50%,
                rgba(118, 75, 162, 0.2) 100%);
            z-index: 2;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .gallery-item:hover::before {
            opacity: 1;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: filter 0.6s ease;
            filter: brightness(0.9);
        }

        .gallery-item:hover img {
            filter: blur(8px) brightness(0.6);
        }

        .gallery-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1.5rem;
            background: linear-gradient(to top, 
                rgba(10, 14, 35, 0.98) 0%,
                rgba(10, 14, 35, 0.95) 70%,
                transparent 100%);
            backdrop-filter: blur(10px);
            color: white;
            transform: translateY(100%);
            transition: transform 0.4s ease;
            z-index: 3;
            border-top: 2px solid rgba(102, 126, 234, 0.5);
        }

        .gallery-item:hover .gallery-caption {
            transform: translateY(0);
        }

        .gallery-caption h4 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: #667eea;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.8);
        }

        .gallery-caption p {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
            margin: 0;
        }

        .gallery-item.featured {
            grid-column: span 2;
            height: 400px;
        }

        .gallery-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 4;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
            animation: badgePulse 2s ease-in-out infinite;
        }

        @keyframes badgePulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 6px 20px rgba(102, 126, 234, 0.8);
            }
        }

        /* Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .lightbox.active {
            display: flex;
        }

        .lightbox img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 0 50px rgba(102, 126, 234, 0.5);
        }

        .lightbox-close {
            position: absolute;
            top: 30px;
            right: 30px;
            font-size: 3rem;
            color: white;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
        }

        .lightbox-close:hover {
            color: #667eea;
            transform: rotate(90deg) scale(1.2);
        }

        /* Footer with Spider Web Theme Navigation */
        footer {
            background: rgba(10, 14, 35, 0.95);
            backdrop-filter: blur(15px);
            border-top: 3px solid rgba(102, 126, 234, 0.4);
            color: white;
            text-align: center;
            padding: 3rem 2rem 2rem;
            margin-top: 1rem;
            position: relative;
            overflow: hidden;
        }

        /* Animated Spider Web Background */
        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-radial-gradient(
                    circle at 50% 50%,
                    transparent 0px,
                    rgba(102, 126, 234, 0.1) 1px,
                    transparent 2px,
                    transparent 80px
                ),
                repeating-radial-gradient(
                    circle at 30% 20%,
                    transparent 0px,
                    rgba(118, 75, 162, 0.08) 1px,
                    transparent 2px,
                    transparent 60px
                ),
                repeating-radial-gradient(
                    circle at 70% 80%,
                    transparent 0px,
                    rgba(240, 147, 251, 0.08) 1px,
                    transparent 2px,
                    transparent 60px
                );
            animation: webShimmer 8s ease-in-out infinite;
            opacity: 0.4;
            pointer-events: none;
        }

        footer::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent 0px,
                    rgba(255, 255, 255, 0.05) 1px,
                    transparent 2px,
                    transparent 100px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent 0px,
                    rgba(255, 255, 255, 0.05) 1px,
                    transparent 2px,
                    transparent 100px
                );
            animation: webFloat 15s ease-in-out infinite;
            opacity: 0.3;
            pointer-events: none;
        }

        @keyframes webFloat {
            0%, 100% {
                opacity: 0.3;
                transform: translateY(0);
            }
            50% {
                opacity: 0.5;
                transform: translateY(-5px);
            }
        }

        .racing-track-nav {
            max-width: 1400px;
            margin: 0 auto 3rem;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 3rem;
            align-items: center;
            position: relative;
            padding: 2rem 0;
        }

        .track-line {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg,
                rgba(102, 126, 234, 0.3) 0%,
                rgba(102, 126, 234, 0.8) 50%,
                rgba(102, 126, 234, 0.3) 100%
            );
            transform: translateY(-50%);
            z-index: 0;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .track-line::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: repeating-linear-gradient(
                90deg,
                rgba(255, 255, 255, 0.3) 0px,
                rgba(255, 255, 255, 0.3) 2px,
                transparent 2px,
                transparent 20px
            );
            transform: translateY(-50%);
            animation: silkGlimmer 3s ease-in-out infinite;
        }

        @keyframes silkGlimmer {
            0%, 100% {
                opacity: 0.5;
            }
            50% {
                opacity: 1;
            }
        }

        .track-checkpoint {
            background: linear-gradient(135deg,
                rgba(10, 14, 35, 0.95) 0%,
                rgba(20, 25, 50, 0.95) 100%
            );
            border: 3px solid rgba(102, 126, 234, 0.4);
            border-radius: 20px;
            padding: 1.5rem 2rem;
            text-decoration: none;
            color: white;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            transition: all 0.4s ease;
            position: relative;
            z-index: 2;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(102, 126, 234, 0.2);
        }

        .track-checkpoint::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-radial-gradient(
                    circle at 50% 50%,
                    transparent 0px,
                    rgba(102, 126, 234, 0.1) 1px,
                    transparent 2px,
                    transparent 20px
                ),
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 15px,
                    rgba(102, 126, 234, 0.05) 15px,
                    rgba(102, 126, 234, 0.05) 30px
                );
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .track-checkpoint:hover::before {
            opacity: 1;
        }

        .track-checkpoint:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: rgba(102, 126, 234, 0.9);
            box-shadow: 
                0 15px 45px rgba(102, 126, 234, 0.4),
                0 0 60px rgba(102, 126, 234, 0.3),
                inset 0 1px 0 rgba(102, 126, 234, 0.4);
        }

        .checkpoint-left {
            justify-content: flex-start;
        }

        .checkpoint-right {
            justify-content: flex-end;
        }

        .checkpoint-flag {
            font-size: 2.5rem;
            filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.5));
            animation: spiderWiggle 2s ease-in-out infinite;
        }

        @keyframes spiderWiggle {
            0%, 100% { transform: rotate(-8deg); }
            50% { transform: rotate(8deg); }
        }

        .speed-arrow {
            font-size: 2.5rem;
            color: #667eea;
            text-shadow: 0 0 20px rgba(102, 126, 234, 0.8);
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .track-checkpoint:hover .speed-arrow {
            color: #f093fb;
            text-shadow: 0 0 30px rgba(240, 147, 251, 0.9);
        }

        .checkpoint-left:hover .speed-arrow {
            transform: translateX(-10px);
        }

        .checkpoint-right:hover .speed-arrow {
            transform: translateX(10px);
        }

        .checkpoint-content {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
            text-align: left;
        }

        .checkpoint-right .checkpoint-content {
            text-align: right;
        }

        .checkpoint-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 700;
        }

        .checkpoint-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .pit-stop {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 60px;
            padding: 1.5rem 3rem;
            text-decoration: none;
            color: white;
            font-weight: 700;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.4s ease;
            box-shadow: 
                0 10px 40px rgba(102, 126, 234, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 3;
            white-space: nowrap;
        }

        .pit-stop::before {
            content: '';
            position: absolute;
            inset: -3px;
            background: 
                repeating-radial-gradient(
                    circle at 50% 50%,
                    #667eea 0%,
                    #764ba2 25%,
                    #f093fb 50%,
                    #4facfe 75%,
                    #667eea 100%
                );
            background-size: 300% 300%;
            border-radius: 60px;
            z-index: -1;
            animation: borderGlow 3s linear infinite;
            filter: blur(8px);
        }

        .pit-stop:hover {
            transform: translateY(-10px) scale(1.08);
            box-shadow: 
                0 20px 60px rgba(102, 126, 234, 0.8),
                0 0 80px rgba(240, 147, 251, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
        }

        .pit-stop-icon {
            font-size: 2rem;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
        }

        .pit-stop-text {
            font-size: 1.1rem;
            letter-spacing: 2px;
        }

        .pit-stop-lights {
            display: flex;
            gap: 0.4rem;
            margin-top: 0.3rem;
        }

        .light {
            width: 8px;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
            animation: webDroplet 2s ease-in-out infinite;
        }

        .light:nth-child(1) {
            animation-delay: 0s;
        }

        .light:nth-child(2) {
            animation-delay: 0.6s;
        }

        .light:nth-child(3) {
            animation-delay: 1.2s;
        }

        @keyframes webDroplet {
            0%, 100% {
                background: rgba(255, 255, 255, 0.3);
                box-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
                transform: scale(1);
            }
            50% {
                background: rgba(102, 126, 234, 0.9);
                box-shadow: 0 0 15px rgba(102, 126, 234, 0.9);
                transform: scale(1.2);
            }
        }

        .racing-divider {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            margin: 0 auto 2rem;
            max-width: 600px;
        }

        .divider-line {
            flex: 1;
            height: 3px;
            background: linear-gradient(90deg,
                transparent 0%,
                rgba(102, 126, 234, 0.6) 50%,
                transparent 100%
            );
            position: relative;
        }

        .divider-line::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: repeating-linear-gradient(
                90deg,
                transparent 0px,
                white 5px,
                white 10px,
                transparent 10px,
                transparent 20px
            );
            transform: translateY(-50%);
        }

        .race-finish {
            font-size: 2rem;
            filter: drop-shadow(0 0 15px rgba(102, 126, 234, 0.8));
            animation: webGlow 2s ease-in-out infinite;
        }

        @keyframes webGlow {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 15px rgba(102, 126, 234, 0.8));
            }
            50% {
                transform: scale(1.1);
                filter: drop-shadow(0 0 25px rgba(102, 126, 234, 1));
            }
        }

        footer p {
            color: rgba(255, 255, 255, 0.8);
            margin: 0.5rem 0;
            position: relative;
            z-index: 1;
        }

        footer a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        footer a:hover {
            color: #f093fb;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .side-info-cards {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .project-hero {
                height: 400px;
                min-height: 400px;
            }

            .hero-content h1 {
                font-size: 2rem;
            }

            .hero-content .subtitle {
                font-size: 1.1rem;
            }

            .content-section {
                padding: 2rem 1.5rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .image-gallery {
                grid-template-columns: 1fr;
            }

            .gallery-item,
            .gallery-item.featured {
                height: 350px;
                grid-column: span 1;
            }

            .model-controls {
                flex-wrap: wrap;
                padding: 0.8rem 1rem;
                gap: 0.5rem;
            }

            .model-control-btn {
                padding: 0.5rem 1rem;
                font-size: 0.75rem;
            }

            .racing-track-nav {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                padding: 1.5rem 0;
            }

            .track-line {
                display: none;
            }

            .track-checkpoint {
                padding: 1.2rem 1.5rem;
                gap: 1rem;
                justify-content: center;
            }

            .checkpoint-left,
            .checkpoint-right {
                justify-content: center;
            }

            .checkpoint-content {
                text-align: center !important;
            }

            .checkpoint-flag {
                font-size: 2rem;
            }

            .speed-arrow {
                font-size: 2rem;
            }

            .checkpoint-title {
                font-size: 1rem;
            }

            .checkpoint-label {
                font-size: 0.7rem;
            }

            .pit-stop {
                order: -1;
                padding: 1.2rem 2rem;
            }

            .pit-stop-icon {
                font-size: 1.5rem;
            }

            .pit-stop-text {
                font-size: 0.95rem;
            }

            .racing-divider {
                gap: 1rem;
            }

            .race-finish {
                font-size: 1.5rem;
            }
        }

        /* ========================================
        ENGINEERING JOURNEY TIMELINE DESIGN
        ======================================== */

        .journey-timeline {
            position: relative;
            padding: 2rem 0;
            margin: 2rem 0;
        }

        /* Vertical connecting line */
        .journey-timeline::before {
            content: '';
            position: absolute;
            left: 50px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(180deg,
                rgba(102, 126, 234, 0.3) 0%,
                rgba(102, 126, 234, 0.8) 50%,
                rgba(102, 126, 234, 0.3) 100%
            );
            border-radius: 2px;
        }

        .journey-phase {
            display: flex;
            gap: 3rem;
            margin-bottom: 3rem;
            position: relative;
            align-items: flex-start;
        }

        .journey-phase:last-child {
            margin-bottom: 0;
        }

        /* Phase Marker (Number + Icon) */
        .phase-marker {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            flex-shrink: 0;
        }

        .phase-number {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 700;
            color: white;
            border: none; 
            box-shadow: 
                0 8px 32px rgba(102, 126, 234, 0.6),
                inset 0 2px 8px rgba(255, 255, 255, 0.2);
            transition: all 0.4s ease;
        }

        .phase-icon {
            font-size: 2.5rem;
            filter: drop-shadow(0 4px 15px rgba(102, 126, 234, 0.6));
            animation: iconFloat 3s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        .journey-phase:hover .phase-number {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 
                0 12px 40px rgba(102, 126, 234, 0.8),
                inset 0 2px 8px rgba(255, 255, 255, 0.3);
        }

        /* Phase Content */
        .phase-content {
            flex: 1;
            background: rgba(102, 126, 234, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 20px;
            padding: 2rem;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .phase-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(180deg,
                #667eea 0%,
                #764ba2 50%,
                #f093fb 100%
            );
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .phase-content:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: rgba(102, 126, 234, 0.6);
            transform: translateX(10px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
        }

        .phase-content:hover::before {
            opacity: 1;
        }

        .phase-title {
            font-size: 1.8rem;
            color: #667eea;
            margin: 0 0 1.5rem 0;
            text-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        /* Skill Tags */
        .phase-skills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .skill-tag {
            background: linear-gradient(135deg, 
                rgba(102, 126, 234, 0.3) 0%, 
                rgba(118, 75, 162, 0.3) 100%);
            backdrop-filter: blur(10px);
            padding: 0.5rem 1.2rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .skill-tag:hover {
            background: linear-gradient(135deg, 
                rgba(102, 126, 234, 0.5) 0%, 
                rgba(118, 75, 162, 0.5) 100%);
            border-color: rgba(102, 126, 234, 0.8);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        /* Phase Insight */
        .phase-insight {
            background: rgba(240, 147, 251, 0.08);
            border-left: 4px solid #f093fb;
            padding: 1.2rem;
            border-radius: 10px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            line-height: 1.6;
            margin: 0;
        }

        .phase-insight strong {
            color: #f093fb;
            text-shadow: 0 0 10px rgba(240, 147, 251, 0.5);
            font-size: 1.05rem;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .journey-timeline::before {
                left: 30px;
            }
            
            .journey-phase {
                gap: 1.5rem;
            }
            
            .phase-number {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .phase-icon {
                font-size: 2rem;
            }
            
            .phase-content {
                padding: 1.5rem;
            }
            
            .phase-title {
                font-size: 1.4rem;
            }
            
            .skill-tag {
                font-size: 0.8rem;
                padding: 0.4rem 1rem;
            }
        }

    </style>
</head>
<body>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar">
            <div class="progress-spider">🕷️</div>
        </div>
    </div>

    <!-- Galaxy Background -->
    <div class="animated-bg"></div>

    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <div onclick="window.scrollTo({top: 0, behavior: 'smooth'})" style="cursor: pointer;">
                <img src="Images/favicon.ico" alt="Yiqing Zhi Logo" class="nav-logo">
            </div>
            <a href="Home_Darker.html#projects" class="back-btn">
                <span>← Back to Portfolio</span>
            </a>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="project-hero">
        <div class="carousel-corner corner-tl"></div>
        <div class="carousel-corner corner-tr"></div>
        <div class="carousel-corner corner-bl"></div>
        <div class="carousel-corner corner-br"></div>
        
        <!-- Left Side Info Cards -->
        <div class="side-info-cards left">
            <div class="info-card" style="animation-delay: 0.2s;">
                <div class="info-icon">🤖</div>
                <div class="info-text">
                    <h4>Robot Type</h4>
                    <p>Quadruped Spider</p>
                </div>
            </div>
            <div class="info-card" style="animation-delay: 0.4s;">
                <div class="info-icon">🦿</div>
                <div class="info-text">
                    <h4>Degrees of Freedom</h4>
                    <p>12 DOF Total</p>
                </div>
            </div>
            <div class="info-card" style="animation-delay: 0.6s;">
                <div class="info-icon">
                    <img src="Images/CAD_icon.png" alt="CAD" style="width: 2.5rem; height: 2.5rem;">
                </div>
                <div class="info-text">
                    <h4>Design Tool</h4>
                    <p>SolidWorks</p>
                </div>
            </div>
        </div>
        
        <!-- Right Side Info Cards -->
        <div class="side-info-cards right">
            <div class="info-card" style="animation-delay: 0.3s;">
                <div class="info-icon">🖨️</div>
                <div class="info-text">
                    <h4>Manufacturing</h4>
                    <p>3D Printed PPS-CF</p>
                </div>
            </div>
            <div class="info-card" style="animation-delay: 0.5s;">
                <div class="info-icon">🎮</div>
                <div class="info-text">
                    <h4>Control</h4>
                    <p>Inverse Kinematics</p>
                </div>
            </div>
            <div class="info-card" style="animation-delay: 0.7s;">
                <div class="info-icon">📐</div>
                <div class="info-text">
                    <h4>Documentation</h4>
                    <p>Technical Drawings</p>
                </div>
            </div>
        </div>
        
        <!-- 3D Canvas Container -->
        <div id="hero-3d-canvas"></div>
        
        <!-- Loading Indicator -->
        <div class="model-loading" id="modelLoading">
            <div style="font-size: 2rem; margin-bottom: 1rem;">⏳</div>
            <div>Loading 3D Spider Robot...</div>
        </div>
        
        <div class="model-controls">
            <button class="model-control-btn" onclick="reset3DView()">🔄 Reset</button>
            <button class="model-control-btn" onclick="toggle3DRotate()" id="rotateBtn">🔁 Rotate</button>
            <button class="model-control-btn" onclick="toggle3DWireframe()" id="wireframeBtn">📐 Wire</button>
            <button class="model-control-btn" onclick="change3DColor()">🎨 Color</button>
            <button class="model-control-btn" onclick="animateLegs()" id="legsBtn">🦿 Walk</button>
        </div>
    </section>

    <!-- Content -->
    <div class="container">
        
        <!-- Project Overview -->
        <div class="content-section">
            <h2 class="section-title">
                <span>🎯</span>
                Project Overview
            </h2>
            <div class="section-content">
                <p>The Four-Foot Spider Robot project focused on creating a complete 3D CAD model of a quadruped robot. I worked with a company in Shanghai to design the full mechanical structure in SolidWorks, building each part accurately and documenting the assembly with technical drawings.</p>
                
                <p>This design uses a 12 degree-of-freedom (DOF) system, with three joints on each leg. This setup would allow the robot to perform movements like walking, turning, and adapting to uneven ground if built in real life. The mechanical layout is inspired by spider-like motion, with attention to stability, weight balance, and efficient structure in the CAD model.</p>
            </div>
        </div>

        <!-- Project Gallery -->
        <div class="content-section">
            <h2 class="section-title">
                <span>📸</span>
                Project Gallery
            </h2>
            <div class="section-content">
                <p>Explore the full CAD design process of the Four-Foot Spider Robot—from early concept sketches to detailed part modeling and final technical documentation.</p>
                
                <h3>🤖 Robot Design & CAD Models</h3>
                <p>Interactive 3D gallery showcasing the mechanical design and detailed component modeling.</p>
            </div>
            
            <!-- 3D Rotating Carousel -->
            <div class="carousel-container" id="robotCarousel">
                <div class="carousel-track">
                    <!-- Slide 1: Complete Assembly -->
                    <div class="carousel-slide" data-index="0">
                        <span class="carousel-badge">🏆 Complete Assembly</span>
                        <img src="Images/Overall3.png" alt="Spider Robot Complete Assembly">
                        <div class="carousel-caption">
                            <h4>Complete Spider Robot - Top View</h4>
                            <p class="short-desc">Fully modeled quadruped with 12 DOF leg system.</p>
                            <p class="long-desc">Complete CAD assembly of a quadruped robot featuring a 12-DOF setup, with four legs that each use three joints. The central body includes space for electronics and key mounting points. Each leg is made up of coxa, femur, and tibia segments designed to support movements such as walking, turning, and adapting to uneven terrain.</p>
                            <div class="caption-expand-btn" onclick="toggleCaption(event)">📖 Read More</div>
                        </div>
                    </div>

                    <!-- SLIDE 2: 3D Printed Parts -->
                    <div class="carousel-slide" data-index="1">
                        <span class="carousel-badge">🖨️ 3D Printed</span>
                        <img src="Images/3d_printed_parts.jpg" alt="3D Printed Robot Parts">
                        <div class="carousel-caption">
                            <h4>3D Printed Components - PPS-CF Material</h4>
                            <p class="short-desc">Additively manufactured parts using carbon fiber reinforced material.</p>
                            <p class="long-desc">The components were 3D printed with PPS-CF (Polyphenylene Sulfide + Carbon Fiber). Prints used a 0.2 mm layer height for good surface quality and a 30% gyroid infill for a strong, lightweight structure. Post-processing included support removal, hole reaming, dimensional checks, and an annealing step to improve strength, stability, and heat resistance.</p>
                            <div class="caption-expand-btn" onclick="toggleCaption(event)">📖 Read More</div>
                        </div>
                    </div>

                    <!-- Slide 3: Engineering Drawing -->
                    <div class="carousel-slide" data-index="2">
                        <span class="carousel-badge">📐 Technical Drawing</span>
                        <img src="Images/Part7_Bot_Body_Top1.png" alt="Engineering Drawings" style="filter: brightness(1.2) contrast(1.1);">
                        <div class="carousel-caption">
                            <h4>Engineering Drawings - Body Component</h4>
                            <p class="short-desc">Detailed technical drawings with full dimensions.</p>
                            <p class="long-desc">Detailed engineering drawing with full dimensions and tolerances for the robot body component. Includes multiple orthographic views, cross-sections, and manufacturing specifications for precision fabrication. <a href="Images/Engineering_Drawings.pdf" target="_blank" style="color: #667eea; text-decoration: underline;">View Full PDF</a></p>
                            <div class="caption-expand-btn" onclick="toggleCaption(event)">📖 Read More</div>
                        </div>
                    </div>

                    <!-- SLIDE 4: Workspace Analysis -->
                    <div class="carousel-slide" data-index="3">
                        <span class="carousel-badge">📊 IK Analysis</span>
                        <img src="Images/Inverse_Kin_Workspace.png" alt="Workspace Analysis">
                        <div class="carousel-caption">
                            <h4>Inverse Kinematics - Workspace Analysis</h4>
                            <p class="short-desc">MATLAB analysis of reachable positions </p>
                            <p class="long-desc"> 3D workspace visualization generated in MATLAB using inverse kinematics. Built from over 12,500 sample points showing all reachable foot positions, with color indicating Z-height. The analysis confirms a 225 mm reach using coxa (45 mm), femur (90 mm), and tibia (90 mm) segments. A geometric IK solver with 0.01 mm accuracy was used to validate motion planning. </p>
                            <div class="caption-expand-btn" onclick="toggleCaption(event)">📖 Read More</div>
                        </div>
                    </div>

                    <!-- SLIDE 5: Walking Gait -->
                    <div class="carousel-slide" data-index="4">
                        <span class="carousel-badge">🎬 Gait Simulation</span>
                        <video autoplay loop muted playsinline style="width: 100%; height: 100%; object-fit: cover;">
                            <source src="Images/Spider_Leg_Walking.mp4" type="video/mp4">
                        </video>
                        <div class="carousel-caption">
                            <h4>Walking Gait Generation & Simulation</h4>
                            <p class="short-desc">MATLAB-generated tripod gait (50mm stride, 35mm step height).</p>
                            <p class="long-desc">Real-time animation of the parametric walking trajectory generated in MATLAB. It uses a tripod gait with a 50 mm stride and a 35 mm step height. The magenta line shows the full foot path, including the swing phase (lifting and moving forward) and the stance phase (ground contact). All joint angles stay within safe mechanical limits (θ₁: ±60°, θ₂: ±90°, θ₃: –135° to +30°).</p>
                            <div class="caption-expand-btn" onclick="toggleCaption(event)">📖 Read More</div>
                        </div>
                    </div>

                    <!-- SLIDE 6: Joint Trajectories -->
                    <div class="carousel-slide" data-index="5">
                        <span class="carousel-badge">📈 Motion Analysis</span>
                        <img src="Images/Inverse_Kin_Joint.jpg" alt="Joint Angle Profiles">
                        <div class="carousel-caption">
                            <h4>Joint Angle Trajectory Analysis</h4>
                            <p class="short-desc">Time-series joint angle profiles during walking cycle.</p>
                            <p class="long-desc">MATLAB-generated plots showing coxa (θ₁), femur (θ₂), and tibia (θ₃) joint angles over a full gait cycle. The smooth curves confirm continuous motion with no singularities or joint limit issues. Forward kinematics checks validate the IK results with less than 0.01 mm position error. Computation time is about 0.1 ms per solution, supporting real-time use in embedded control. <a href="Inverse_Kinematics.m" download style="color: #667eea; text-decoration: underline;">Download MATLAB Code</a></p>
                            <div class="caption-expand-btn" onclick="toggleCaption(event)">📖 Read More</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Carousel Controls -->
            <div class="carousel-controls">
                <button class="carousel-btn" onclick="prevSlide('robotCarousel')">❮</button>
                <div class="carousel-dots" id="robotDots"></div>
                <button class="carousel-btn" onclick="nextSlide('robotCarousel')">❯</button>
            </div>

        </div>

        <!-- My Contributions -->
        <div class="content-section">
            <h2 class="section-title">
                <span>⚡</span>
                My Contributions
            </h2>
            <div class="section-content">
                <h3>🔧 Mechanical Design & CAD Engineering</h3>
                <p>Developed the full mechanical layout and 3D CAD struture of the quadruped robot.</p>
                <ul>
                    <li>Developed the full 3D CAD assembly in SolidWorks, including all body and leg components.</li>
                    <li>Designed a 12-DOF leg system with defined joint limits and stable kinematic configuration.</li>
                    <li>Optimized structural strength and weight through iterative design updates and motion studies.</li>
                    <li>Performed interference checks and ensured proper clearances across all moving joints.</li>
                </ul>

                <h3>📐 Technical Documentation & Manufacturing Readiness</h3>
                <p>Produced complete engineering documentation and prepared the design for fabrication.</p>
                <ul>
                    <li>Created detailed engineering drawings with dimensions, tolerances, and GD&T requirements.</li>
                    <li>Developed clear assembly documentation, including exploded views and part relationships.</li>
                    <li>Prepared material specifications and bill of materials for potential fabrication.</li>
                    <li>Evaluated manufacturability for 3D printing, including print orientation and tolerance stack-up.</li>
                </ul>

                <h3>🔬 Kinematic Analysis & MATLAB Simulation</h3>
                <p>Developed and validated the robot’s motion algorithms using MATLAB simulation tools.</p>
                <ul>
                    <li>Built a geometric inverse kinematics solver in MATLAB within 0.01 mm accuracy.</li>
                    <li>Generated a 3D workspace map using 12,500+ sample configurations across joint ranges.</li>
                    <li>Programmed a tripod gait trajectory (50 mm stride, 35 mm step height) within all joint limits.</li>
                    <li>Validated motion using forward kinematics and real-time animation of foot paths and joint angles.</li>
                </ul>

            </div>
        </div>

        <!-- Design Journey -->
        <div class="content-section">
            <h2 class="section-title">
                <span>🕷️</span>
                Design Journey
            </h2>
            
            <div class="section-content">
                <p style="text-align: center; font-size: 1.2rem; margin-bottom: 3rem; color: rgba(255, 255, 255, 0.9);">
                    From concept sketches to fully detailed CAD model - here's how this project developed my mechanical design expertise
                </p>
            </div>

            <div class="journey-timeline">

                <!-- Phase 1 -->
                <div class="journey-phase">
                    <div class="phase-marker">
                        <div class="phase-number">01</div>
                        <div class="phase-icon">💡</div>
                    </div>
                    <div class="phase-content">
                        <h3 class="phase-title">Concept Development</h3>
                        <div class="phase-skills">
                            <span class="skill-tag">Biomimetic Design</span>
                            <span class="skill-tag">DOF Planning</span>
                            <span class="skill-tag">Kinematic Research</span>
                            <span class="skill-tag">Concept Sketching</span>
                        </div>
                        <p class="phase-insight">
                            <strong>💡 Key Insight:</strong> Defined the initial concept for a spider-inspired 12-DOF quadruped. Set basic movement goals and outlined how the legs and body should work together.
                        </p>
                    </div>
                </div>

                <!-- Phase 2 -->
                <div class="journey-phase">
                    <div class="phase-marker">
                        <div class="phase-number">02</div>
                        <div class="phase-icon">
                            <img src="Images/CAD_icon.png" style="width:2.5rem; height:2.5rem; filter: drop-shadow(0 4px 15px rgba(102,126,234,0.6));">
                        </div>
                    </div>
                    <div class="phase-content">
                        <h3 class="phase-title">Mechanical CAD Modeling</h3>
                        <div class="phase-skills">
                            <span class="skill-tag">SolidWorks</span>
                            <span class="skill-tag">Part Modeling</span>
                            <span class="skill-tag">Assembly Design</span>
                            <span class="skill-tag">Interference Checking</span>
                        </div>
                        <p class="phase-insight">
                            <strong>💡 Key Insight:</strong> Built the complete 3D assembly, including chassis, leg segments, and joints. Learned the importance of clean mates and consistent geometry to avoid assembly issues.
                        </p>
                    </div>
                </div>

                <!-- Phase 3 -->
                <div class="journey-phase">
                    <div class="phase-marker">
                        <div class="phase-number">03</div>
                        <div class="phase-icon">⚙️</div>
                    </div>
                    <div class="phase-content">
                        <h3 class="phase-title">Kinematic Analysis</h3>
                        <div class="phase-skills">
                            <span class="skill-tag">Inverse Kinematics</span>
                            <span class="skill-tag">Workspace Mapping</span>
                            <span class="skill-tag">Motion Simulation</span>
                            <span class="skill-tag">Collision Detection</span>
                        </div>
                        <p class="phase-insight">
                            <strong>💡 Key Insight:</strong> Validated all 12 DOF using MATLAB. Workspace analysis and motion studies caught clearance issues that weren’t visible in static CAD views.
                        </p>
                    </div>
                </div>

                <!-- Phase 4 -->
                <div class="journey-phase">
                    <div class="phase-marker">
                        <div class="phase-number">04</div>
                        <div class="phase-icon">📝</div>
                    </div>
                    <div class="phase-content">
                        <h3 class="phase-title">Optimization & Documentation</h3>
                        <div class="phase-skills">
                            <span class="skill-tag">Design Refinement</span>
                            <span class="skill-tag">Weight Reduction</span>
                            <span class="skill-tag">Engineering Drawings</span>
                            <span class="skill-tag">BOM Creation</span>
                        </div>
                        <p class="phase-insight">
                            <strong>💡 Key Insight:</strong> Applied Six Sigma method to optimize the design, reduce weight, and create clear, fabrication-ready documentation.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <span class="lightbox-close">×</span>
        <img src="" alt="Full size image" id="lightbox-img">
    </div>

    <!-- Footer -->
    <footer>
        <div class="racing-track-nav">
            <div class="track-line"></div>
            
            <a href="Project-uwfe-3D.html" class="track-checkpoint checkpoint-left">
                <div class="checkpoint-flag">🏎️</div>
                <div class="checkpoint-content">
                    <span class="checkpoint-label">PREVIOUS PROJECT</span>
                    <span class="checkpoint-title">Waterloo Formula Electric</span>
                </div>
                <div class="speed-arrow">←</div>
            </a>
            
            <a href="index.html#projects" class="pit-stop">
                <div class="pit-stop-icon">🕸️</div>
                <span class="pit-stop-text">ALL PROJECTS</span>
                <div class="pit-stop-lights">
                    <span class="light"></span>
                    <span class="light"></span>
                    <span class="light"></span>
                </div>
            </a>
            
            <a href="Project-circadian_rhythm_device.html" class="track-checkpoint checkpoint-right">
                <div class="speed-arrow">→</div>
                <div class="checkpoint-content">
                    <span class="checkpoint-label">NEXT PROJECT</span>
                    <span class="checkpoint-title">Circadian Rhythm Regulating Device</span>
                </div>
                <div class="checkpoint-flag">⏰</div>
            </a>
        </div>

        <div class="racing-divider">
            <div class="divider-line"></div>
            <span class="race-finish">🕸️</span>
            <div class="divider-line"></div>
        </div>

        <p style="font-size: 0.95rem; letter-spacing: 1px;">Copyright © 2025 Yiqing Zhi</p>
    </footer>

    <script>
        // Progress Bar Update on Scroll
        window.addEventListener('scroll', function() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('progressBar').style.width = scrolled + '%';
        });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Lightbox functionality
        const galleryItems = document.querySelectorAll('.gallery-item img');
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');

        galleryItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.stopPropagation();
                lightbox.classList.add('active');
                lightboxImg.src = this.src;
            });
        });

        function closeLightbox() {
            lightbox.classList.remove('active');
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeLightbox();
            }
        });

        // ==========================================
        // 3D SPIDER ROBOT MODEL VIEWER
        // ==========================================
        let scene3D, camera3D, renderer3D, controls3D, spiderModel;
        let autoRotate3D = false, wireframeMode3D = false, colorIndex = 0;
        let legAnimation = null, isAnimatingLegs = false; 
        const modelColors = [
            0x2a2a2a,  // Dark grey (default)
            0x505050,  // Medium grey
            0x3d4a75,  // Dark purple-blue
            0x1a0b3d   // Deep space blue-purple (galaxy color)
        ];
        let rotationPhase = 'horizontal';
        let rotationProgress = 0;
        let initialRotation = { x: 0, y: 0, z: 0 };
        let initialPosition = { x: 0, y: 0, z: 0 };

        function init3DSpider() {
            const container = document.getElementById('hero-3d-canvas');
            if (!container) return;

            scene3D = new THREE.Scene();
            camera3D = new THREE.PerspectiveCamera(50, container.clientWidth / container.clientHeight, 0.1, 1000);
            
            // Position camera to view spider robot
            camera3D.position.set(40, 70, 45); 
            camera3D.lookAt(0, 0, 0);

            renderer3D = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer3D.setSize(container.clientWidth, container.clientHeight);
            renderer3D.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            container.appendChild(renderer3D.domElement);

            controls3D = new THREE.OrbitControls(camera3D, renderer3D.domElement);
            controls3D.enableDamping = true;
            controls3D.dampingFactor = 0.05;
            controls3D.minDistance = 20;
            controls3D.maxDistance = 200;
            controls3D.target.set(0, 0, 0);

            // Enhanced Lighting System
            // Stronger ambient light to eliminate dark areas
            scene3D.add(new THREE.AmbientLight(0xffffff, 1.2));

            // Key light - main illumination
            const keyLight = new THREE.DirectionalLight(0xffffff, 1.5);
            keyLight.position.set(50, 80, 40);
            keyLight.castShadow = true;
            scene3D.add(keyLight);

            // Fill light - reduces shadows
            const fillLight = new THREE.DirectionalLight(0x667eea, 0.8);
            fillLight.position.set(-50, 40, -40);
            scene3D.add(fillLight);

            // Back light - adds depth
            const backLight = new THREE.DirectionalLight(0xf093fb, 0.6);
            backLight.position.set(0, 30, -60);
            scene3D.add(backLight);

            // Hemisphere light for natural ambient
            const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.6);
            hemiLight.position.set(0, 100, 0);
            scene3D.add(hemiLight);

            load3DModel();
            
            window.addEventListener('resize', () => {
                camera3D.aspect = container.clientWidth / container.clientHeight;
                camera3D.updateProjectionMatrix();
                renderer3D.setSize(container.clientWidth, container.clientHeight);
            });

            animate3D();
        }

        function load3DModel() {
            const loader = new THREE.GLTFLoader();
            loader.load(
                'Images/Robot_Overall_Assembly.glb',  
                (gltf) => {
                    spiderModel = gltf.scene;
                    
                    // 🔍 DIAGNOSTIC: Log all available parts
                    console.log('=== ROBOT MODEL STRUCTURE ===');
                    spiderModel.traverse((child) => {
                        if (child.isMesh || child.isGroup || child.isObject3D) {
                            console.log(`Name: "${child.name}", Type: ${child.type}`);
                        }
                    });
                    console.log('============================');
                    
                    const box = new THREE.Box3().setFromObject(spiderModel);
                    const center = box.getCenter(new THREE.Vector3());
                    const size = box.getSize(new THREE.Vector3());
                    const scale = 60 / Math.max(size.x, size.y, size.z);

                    spiderModel.scale.multiplyScalar(scale);

                    // Create a wrapper group for proper rotation pivot
                    const modelGroup = new THREE.Group();
                    spiderModel.position.set(-center.x * scale, -center.y * scale, -center.z * scale);
                    modelGroup.add(spiderModel);

                    // Update the reference to use the group instead
                    spiderModel = modelGroup;
                    
                    spiderModel.rotation.x = Math.PI;
                    spiderModel.rotation.y = 0;
                    spiderModel.rotation.z = 0;

                    initialRotation = {
                        x: spiderModel.rotation.x,
                        y: spiderModel.rotation.y,
                        z: spiderModel.rotation.z
                    };
                    initialPosition = {
                        x: spiderModel.position.x,
                        y: spiderModel.position.y,
                        z: spiderModel.position.z
                    };
                    
                    spiderModel.traverse((child) => {
                        if (child.isMesh) {
                            child.castShadow = true;
                            child.receiveShadow = true;
                            
                            if (child.material) {
                                child.material.color.setHex(0x2a2a2a);
                                child.material.metalness = 0.3;
                                child.material.roughness = 0.6;
                                child.userData.originalColor = child.material.color.clone();
                            }
                        }
                    });
                    
                    scene3D.add(spiderModel);
                    hideModelLoading();
                    gsap.from(spiderModel.scale, { x: 0, y: 0, z: 0, duration: 1.5, ease: "back.out(1.7)" });
                },
                (xhr) => updateLoadingText(`Loading... ${Math.round((xhr.loaded / xhr.total) * 100)}%`),
                (error) => { console.error('Error:', error); updateLoadingText('❌ Model load failed'); }
            );
        }

        function animate3D() {
            requestAnimationFrame(animate3D);
            if (controls3D) controls3D.update();
            
            if (spiderModel && autoRotate3D) {
                const rotationSpeed = 0.005;
                
                if (rotationPhase === 'horizontal') {
                    spiderModel.rotation.y += rotationSpeed;
                    rotationProgress += rotationSpeed;
                    
                    if (rotationProgress >= Math.PI * 2) {
                        rotationPhase = 'vertical';
                        rotationProgress = 0;
                    }
                } else if (rotationPhase === 'vertical') {
                    spiderModel.rotation.x += rotationSpeed;
                    rotationProgress += rotationSpeed;
                    
                    if (rotationProgress >= Math.PI * 2) {
                        rotationPhase = 'horizontal';
                        rotationProgress = 0;
                    }
                }
            }
            
            renderer3D.render(scene3D, camera3D);
        }

        function hideModelLoading() {
            const loading = document.getElementById('modelLoading');
            if (loading) setTimeout(() => loading.classList.add('hidden'), 300);
        }

        function updateLoadingText(text) {
            const loading = document.getElementById('modelLoading');
            if (loading) {
                const textDiv = loading.querySelector('div:last-child');
                if (textDiv) textDiv.textContent = text;
            }
        }

        function reset3DView() {
            if (!camera3D || !controls3D || !spiderModel) return;
            
            // Stop any active animations
            if (autoRotate3D) {
                autoRotate3D = false;
                const rotateBtn = document.getElementById('rotateBtn');
                if (rotateBtn) rotateBtn.textContent = '🔁 Rotate';
            }
            
            if (isAnimatingLegs) {
                isAnimatingLegs = false;
                stopLegAnimation();
                const legsBtn = document.getElementById('legsBtn');
                if (legsBtn) legsBtn.textContent = '🦿 Walk';
            }
            
            rotationPhase = 'horizontal';
            rotationProgress = 0;
            controls3D.enabled = false;
            
            gsap.to(spiderModel.rotation, {
                x: initialRotation.x,
                y: initialRotation.y,
                z: initialRotation.z,
                duration: 1.5,
                ease: "power2.inOut"
            });
            
            gsap.to(spiderModel.position, {
                x: initialPosition.x,
                y: initialPosition.y,
                z: initialPosition.z,
                duration: 1.5,
                ease: "power2.inOut"
            });
            
            gsap.to(camera3D.position, { 
                x: 40, 
                y: 70, 
                z: 45, 
                duration: 1.5, 
                ease: "power2.inOut",
                onUpdate: () => {
                    camera3D.lookAt(0, 0, 0);
                    controls3D.update();
                }
            });
            
            gsap.to(controls3D.target, { 
                x: 0, 
                y: 0, 
                z: 0, 
                duration: 1.5, 
                ease: "power2.inOut",
                onComplete: () => {
                    controls3D.enabled = true;
                }
            });
        }
        function toggle3DRotate() {
            autoRotate3D = !autoRotate3D;
            
            if (autoRotate3D) {
                rotationPhase = 'horizontal';
                rotationProgress = 0;
            }
            
            const btn = document.getElementById('rotateBtn');
            if (btn) btn.textContent = autoRotate3D ? '⏸️ Stop' : '🔁 Rotate';
        }

        function toggle3DWireframe() {
            if (!spiderModel) return;
            wireframeMode3D = !wireframeMode3D;
            
            spiderModel.traverse((child) => {
                if (child.isMesh && child.material) {
                    if (wireframeMode3D) {
                        // Just enable wireframe, keep current color
                        child.material.wireframe = true;
                        child.material.opacity = 0.9;
                        child.material.transparent = true;
                    } else {
                        // Just disable wireframe, keep current color
                        child.material.wireframe = false;
                        child.material.opacity = 1.0;
                        child.material.transparent = false;
                    }
                }
            });
            
            const btn = document.getElementById('wireframeBtn');
            if (btn) btn.textContent = wireframeMode3D ? '🎨 Solid' : '📐 Wire';
        }

        function change3DColor() {
            if (!spiderModel) return;
            colorIndex = (colorIndex + 1) % modelColors.length;
            const newColor = modelColors[colorIndex];
            
            spiderModel.traverse((child) => {
                if (child.isMesh && child.material) {
                    // Apply color regardless of wireframe mode
                    gsap.to(child.material.color, {
                        r: ((newColor >> 16) & 255) / 255,
                        g: ((newColor >> 8) & 255) / 255,
                        b: (newColor & 255) / 255,
                        duration: 0.5
                    });
                }
            });
        }

        // Initialize 3D viewer when page loads
        window.addEventListener('load', () => setTimeout(init3DSpider, 500));

        const carousels = {
            robotCarousel: { currentIndex: 0, totalSlides: 6 },
        };

        // AUTO-ROTATION SETTINGS
        let autoRotateTimer = null;
        const AUTO_ROTATE_DELAY = 5000;     // normal slides
        const VIDEO_ROTATE_DELAY = 8000;   // how long to stay on video slide (ms)
        const VIDEO_SLIDE_INDEX = 5;        // your video slide is data-index="5"
        let isUserInteracting = false;
        let isMouseOverCarousel = false;

        // Decide how long to wait before rotating away from current slide
        function getCurrentSlideDelay(carouselId) {
            const current = carousels[carouselId].currentIndex;

            // If we're on the video slide in robotCarousel, use longer delay
            if (carouselId === 'robotCarousel' && current === VIDEO_SLIDE_INDEX) {
                return VIDEO_ROTATE_DELAY;
            }

            // Otherwise, normal delay
            return AUTO_ROTATE_DELAY;
        }

        function scheduleNextAutoRotate(carouselId) {
            // Clear any existing timer
            if (autoRotateTimer) {
                clearTimeout(autoRotateTimer);
                autoRotateTimer = null;
            }

            const delay = getCurrentSlideDelay(carouselId);

            autoRotateTimer = setTimeout(() => {
                // Only auto-rotate if user is not interacting or hovering
                if (!isUserInteracting && !isMouseOverCarousel) {
                    nextSlide(carouselId);
                }
                // Schedule the next rotation based on the NEW current slide
                scheduleNextAutoRotate(carouselId);
            }, delay);
        }

        function startAutoRotate(carouselId) {
            stopAutoRotate();
            scheduleNextAutoRotate(carouselId);
        }

        function stopAutoRotate() {
            if (autoRotateTimer) {
                clearTimeout(autoRotateTimer);
                autoRotateTimer = null;
            }
        }

        // Pause auto-rotation temporarily when user manually clicks
        function pauseAutoRotate() {
            isUserInteracting = true;
            setTimeout(() => {
                isUserInteracting = false;
            }, 5000);
        }

        function initCarousels() {
            Object.keys(carousels).forEach(carouselId => {
                updateCarousel(carouselId);
                createDots(carouselId);
            });
        }

        function updateCarousel(carouselId) {
            const carousel = document.getElementById(carouselId);
            if (!carousel) return;
            
            const slides = carousel.querySelectorAll('.carousel-slide');
            const currentIndex = carousels[carouselId].currentIndex;
            const total = slides.length;
            
            slides.forEach((slide, index) => {
                slide.classList.remove('active', 'left', 'right', 'hidden');
                
                if (index === currentIndex) {
                    slide.classList.add('active');
                } else if (index === (currentIndex - 1 + total) % total) {
                    slide.classList.add('left');
                } else if (index === (currentIndex + 1) % total) {
                    slide.classList.add('right');
                } else {
                    slide.classList.add('hidden');
                }
            });
            
            updateDots(carouselId);
            
            // ✅ FIXED: Pause inactive videos first, then play active one
            pauseInactiveVideos(carouselId);
            
            // Small delay to ensure slide transition completes
            setTimeout(() => {
                playVideoInActiveSlide(carouselId);
            }, 100);
        }

        function createDots(carouselId) {
            const dotsContainer = document.getElementById(carouselId.replace('Carousel', 'Dots'));
            if (!dotsContainer) return;
            
            dotsContainer.innerHTML = '';
            const total = carousels[carouselId].totalSlides;
            
            for (let i = 0; i < total; i++) {
                const dot = document.createElement('div');
                dot.classList.add('carousel-dot');
                if (i === 0) dot.classList.add('active');
                dot.onclick = () => goToSlide(carouselId, i);
                dotsContainer.appendChild(dot);
            }
        }

        function updateDots(carouselId) {
            const dotsContainer = document.getElementById(carouselId.replace('Carousel', 'Dots'));
            if (!dotsContainer) return;
            
            const dots = dotsContainer.querySelectorAll('.carousel-dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === carousels[carouselId].currentIndex);
            });
        }

        function nextSlide(carouselId) {
            pauseAutoRotate();
            const total = carousels[carouselId].totalSlides;
            carousels[carouselId].currentIndex = (carousels[carouselId].currentIndex + 1) % total;
            updateCarousel(carouselId);
            scheduleNextAutoRotate(carouselId); 
        }

        function prevSlide(carouselId) {
            pauseAutoRotate();
            const total = carousels[carouselId].totalSlides;
            carousels[carouselId].currentIndex = (carousels[carouselId].currentIndex - 1 + total) % total;
            updateCarousel(carouselId);
            scheduleNextAutoRotate(carouselId); 
        }

        function goToSlide(carouselId, index) {
            pauseAutoRotate();
            carousels[carouselId].currentIndex = index;
            updateCarousel(carouselId);
            scheduleNextAutoRotate(carouselId); 
        }

        // Initialize carousel on page load
        document.addEventListener('DOMContentLoaded', () => {
            initCarousels();
            
            // Start auto-rotation
            startAutoRotate('robotCarousel');
            playVideoInActiveSlide('robotCarousel');
            
            // Click on side images to navigate
            document.querySelectorAll('.carousel-slide').forEach(slide => {
                slide.addEventListener('click', function() {
                    if (this.classList.contains('left')) {
                        const carouselId = this.closest('.carousel-container').id;
                        prevSlide(carouselId);
                    } else if (this.classList.contains('right')) {
                        const carouselId = this.closest('.carousel-container').id;
                        nextSlide(carouselId);
                    }
                });
            });
            
            // FIXED: Pause auto-rotation when user hovers over carousel
            document.querySelectorAll('.carousel-container').forEach(carousel => {
                carousel.addEventListener('mouseenter', () => {
                    isMouseOverCarousel = true;
                    console.log('Mouse entered carousel - auto-rotation paused');
                });
                
                carousel.addEventListener('mouseleave', () => {
                    isMouseOverCarousel = false;
                    console.log('Mouse left carousel - auto-rotation resumed');
                });
            });
            
            // BONUS: Also pause when hovering over carousel controls
            document.querySelectorAll('.carousel-controls').forEach(controls => {
                controls.addEventListener('mouseenter', () => {
                    isMouseOverCarousel = true;
                });
                
                controls.addEventListener('mouseleave', () => {
                    isMouseOverCarousel = false;
                });
            });
        });

        // Toggle caption expansion
        function toggleCaption(event) {
            event.stopPropagation();
            const caption = event.target.closest('.carousel-caption');
            caption.classList.toggle('expanded');
            
            const btn = event.target;
            if (caption.classList.contains('expanded')) {
                btn.textContent = '📕 Show Less';
            } else {
                btn.textContent = '📖 Read More';
            }
        }

        function animateLegs() {
            if (!spiderModel) return;
            
            isAnimatingLegs = !isAnimatingLegs;
            const btn = document.getElementById('legsBtn');
            
            if (isAnimatingLegs) {
                if (btn) btn.textContent = '⏸️ Stop';
                startLegAnimation();
            } else {
                if (btn) btn.textContent = '🦿 Walk';
                stopLegAnimation();
            }
        }

        function startLegAnimation() {
            const legParts = [];
            
            spiderModel.traverse((child) => {
                if (child.isMesh || child.isGroup) {
                    const name = child.name.toLowerCase();
                    
                    // ONLY animate TIBIA (shin/lower leg) and FOOT parts
                    // These are the parts closest to the ground that move during walking
                    const isLowerLeg = name.includes('tibia') || 
                                    name.includes('shin') ||
                                    name.includes('lower') ||
                                    name.includes('foot') ||
                                    name.includes('ankle');
                    
                    // Exclude upper leg parts (femur, coxa, hip)
                    const isUpperLeg = name.includes('femur') ||
                                    name.includes('coxa') ||
                                    name.includes('hip') ||
                                    name.includes('thigh') ||
                                    name.includes('upper');
                    
                    // Exclude body parts
                    const isBodyPart = name.includes('body') || 
                                    name.includes('chassis') || 
                                    name.includes('base') ||
                                    name.includes('platform') ||
                                    name.includes('main') ||
                                    name.includes('central') ||
                                    name.includes('core') ||
                                    name.includes('frame');
                    
                    // ONLY include lower leg parts, exclude upper leg and body
                    if (isLowerLeg && !isUpperLeg && !isBodyPart) {
                        // Store original rotation if not already stored
                        if (!child.userData.originalRotation) {
                            child.userData.originalRotation = {
                                x: child.rotation.x,
                                y: child.rotation.y,
                                z: child.rotation.z
                            };
                        }
                        
                        legParts.push(child);
                        console.log(`✅ Animating LOWER LEG: ${child.name}`);
                    } else if (isUpperLeg) {
                        console.log(`❌ Skipping UPPER LEG: ${child.name}`);
                    } else if (isBodyPart) {
                        console.log(`❌ Skipping BODY: ${child.name}`);
                    }
                }
            });
            
            console.log(`\n📊 Total LOWER leg parts found: ${legParts.length}\n`);
            
            // If no parts found with specific names, try numbered approach
            if (legParts.length === 0) {
                console.warn('No "tibia" parts found! Trying to find lower segments by position...');
                
                // Try to find parts that might be named differently
                spiderModel.traverse((child) => {
                    if (child.isMesh || child.isGroup) {
                        const name = child.name.toLowerCase();
                        
                        // Look for leg parts but exclude specific upper/body keywords
                        const hasLegKeyword = name.includes('leg');
                        const notUpperOrBody = !name.includes('body') && 
                                            !name.includes('chassis') && 
                                            !name.includes('base') &&
                                            !name.includes('femur') &&
                                            !name.includes('coxa') &&
                                            !name.includes('hip') &&
                                            !name.includes('platform');
                        
                        if (hasLegKeyword && notUpperOrBody) {
                            if (!child.userData.originalRotation) {
                                child.userData.originalRotation = {
                                    x: child.rotation.x,
                                    y: child.rotation.y,
                                    z: child.rotation.z
                                };
                            }
                            legParts.push(child);
                            console.log(`🔄 Fallback - might be lower leg: ${child.name}`);
                        }
                    }
                });
            }
            
            if (legParts.length === 0) {
                console.error('❌ No lower leg parts found!');
                console.log('🔍 Try clicking Walk button and check console to see all part names');
                
                // Debug: List ALL parts in the model
                console.log('\n📋 ALL PARTS IN MODEL:');
                spiderModel.traverse((child) => {
                    if (child.name) {
                        console.log(`   - ${child.name}`);
                    }
                });
                
                alert('No lower leg parts found to animate. Check console for all part names.');
                return;
            }
            
            // Create realistic walking animation - ONLY lower legs move
            const timeline = gsap.timeline({ repeat: -1 });
            
            legParts.forEach((part, index) => {
                // Alternating pattern for spider walking gait
                const phase = index % 2 === 0 ? 0 : 0.5;
                
                // Subtle movement for realistic walking
                const moveAmount = 0.2;
                
                // Animate Y-axis for front-back motion (walking)
                timeline.to(part.rotation, {
                    y: part.userData.originalRotation.y + moveAmount,  // Lift/forward
                    duration: 0.4,
                    ease: 'sine.inOut'
                }, phase);
                
                timeline.to(part.rotation, {
                    y: part.userData.originalRotation.y - (moveAmount * 0.3),  // Plant/backward
                    duration: 0.4,
                    ease: 'sine.inOut'
                }, phase + 0.4);
                
                timeline.to(part.rotation, {
                    y: part.userData.originalRotation.y,  // Return to neutral
                    duration: 0.3,
                    ease: 'sine.inOut'
                }, phase + 0.8);
            });
            
            legAnimation = timeline;
        }

        function animateLegs() {
            if (!spiderModel) return;
            
            isAnimatingLegs = !isAnimatingLegs;
            const btn = document.getElementById('legsBtn');
            
            if (isAnimatingLegs) {
                if (btn) btn.textContent = '⏸️ Stop';
                startLegAnimation();
            } else {
                if (btn) btn.textContent = '🦿 Walk';
                stopLegAnimation();
            }
        }

        function stopLegAnimation() {
            if (legAnimation) {
                legAnimation.kill();
                legAnimation = null;
            }
            
            // Reset all leg parts to original positions
            spiderModel.traverse((child) => {
                if (child.userData.originalRotation) {
                    gsap.to(child.rotation, {
                        x: child.userData.originalRotation.x,
                        y: child.userData.originalRotation.y,
                        z: child.userData.originalRotation.z,
                        duration: 0.5,
                        ease: 'power2.out'
                    });
                }
            });
        }

        function playVideoInActiveSlide(carouselId) {
            const carousel = document.getElementById(carouselId);
            if (!carousel) return;

            // Pause + reset all videos in this carousel
            const allVideos = carousel.querySelectorAll('video');
            allVideos.forEach(video => {
                video.pause();
                video.currentTime = 0;
            });

            // Now find the active slide's video
            const activeSlide = carousel.querySelector('.carousel-slide.active');
            if (!activeSlide) return;

            const video = activeSlide.querySelector('video');
            if (!video) return;

            // Configure playback
            video.loop = true;      
            video.muted = true;
            video.currentTime = 0;
            video.playbackRate = 2.0;

            // ✅ Wait for video metadata to load, then get actual duration
            video.addEventListener('loadedmetadata', function() {
                const actualDuration = (video.duration / video.playbackRate) * 1000; // Convert to ms
                console.log(`Video duration at ${video.playbackRate}x speed: ${actualDuration}ms`);
                
                // ✅ Update the VIDEO_ROTATE_DELAY dynamically
                VIDEO_ROTATE_DELAY = actualDuration + 500; // Add 0.5s buffer
            }, { once: true });

            video.play().catch(err => {
                console.log('Autoplay prevented:', err);
                video.muted = true;
                video.play();
            });
        }


       function pauseInactiveVideos(carouselId) {
            const carousel = document.getElementById(carouselId);
            if (!carousel) return;

            // Only pause/reset videos that are NOT in the active slide
            carousel.querySelectorAll('.carousel-slide:not(.active) video').forEach(video => {
                video.pause();
                video.currentTime = 0;   // so when you come back, it starts fresh
            });
        }


        // Initialize video autoplay when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Wait a bit for carousel to initialize
            setTimeout(() => {
                initVideoAutoplay();
            }, 500);
        });

    </script>

</body>
</html>
